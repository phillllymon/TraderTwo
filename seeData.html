<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Two-Column Dataset Graphs</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    .column {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }
    .chart-container {
      width: 100%;
      height: 300px;
    }
  </style>
</head>
<body>
  <h1>Two-Column Dataset Graphs</h1>
  <div class="grid">
    <div class="column" id="leftCol"></div>
    <div class="column" id="rightCol"></div>
  </div>

  <script>
    // bad
    const leftDatasets = [[8.28,8.3753,9.1195,8.91,8.3891,8.57,8.4001],[5.3728,5.49,5.5183,5.6,5.74,5.5973,5.64],[1820,1848.88,1878.925,1929,1922.84,1875,1876.09],[6.19,6.255,6.2568,6.4991,6.6,6.6712,6.55],[10.069,9.9399,10.25,10.3712,10.2534,10.08,10.001],[7.1,7.1,7.27,7.31,7.3534,7.54,7.389],[8.34,8.53,8.59,8.675,8.85,9.15,9.2],[6.8701,7.0001,7.2501,7.35,7.89,7.5,7.7452],[153,155.045,155.49,161.3447,164.735,165,162],[9.13,9.15,9.4,9.65,9.83,9.9151,10.12],[6.195,6.195,6.36,6.78,6.9,6.81,6.72],[17.3207,19.66,21.11,22.3895,20.25,19.93,20.6],[20.2,20.73,20.94,21.2,21.175,21.17,21.125],[39.87,40.175,40.2,40.65,40.02,40.48,39.8],[5.175,5.25,5.4627,5.555,5.7,5.4995,5.36],[7.58,7.925,8.6476,8.724,8.71,8.9643,9.214],[8.64,8.88,8.96,8.96,9.07,9.09,9.145],[9.135,9.35,9.35,9.4701,9.5299,9.2993,9.32],[41.7975,42.0001,42.13,42.5,42.9,42.325,41.2]];

    // good
    const rightDatasets = [[36.8884,38.3268,38.94,41.5964,41.89,41.2392,41.325],[9.29,9.49,9.905,10.0101,9.8525,10.09,9.985],[8.17,8.203,8.35,8.06,8.1227,8.0999,7.963],[11.59,11.83,12.4242,12.85,12.805,12.855,12.82],[32.3952,33.5,33.6,34.5,35.74,35.055,35.21],[26.8,27.5602,27.685,27.9,28.7933,28.805,29.17],[67.0154,69.1606,69.8,71.3403,73.6951,72.58,73.25],[15.19,16.1595,16.21,16.7162,16.3637,16.6527,16.6],[13.18,13.4988,13.965,14.036,14.47,14.5,14.53],[5.4,5.51,5.6401,5.81,5.9,5.91,5.88],[12.14,12.4124,12.72,13.175,13.0446,12.8147,12.775],[7.63,7.6936,7.8408,8.1,8.35,8.15,7.9],[6.95,7.035,7.04,7.17,7.1,6.9061,6.8],[7.02,7.15,7.38,7.9,7.98,7.9408,7.4729],[17.37,17.85,18.0595,18.477,18.7459,19.4053,20.94],[22.47,23.14,23.9891,24.135,24.2,24.16,24.055],[7.97,8.0357,8.0948,8.325,8.432,8.49,8.65],[24.47,24.65,25.1,25.68,25.735,26.6597,27.175],[26.6799,27.2,27.435,29,29.705,29.88,30.9],[6.7288,6.7881,6.9188,7.22,7.0318,7.0788,7.4335],[56.6,57.41,58.06,60.84,63.58,61.34,61.67],[11.84,11.92,11.9653,11.99,12,12.04,11.985],[20,20.989,21.61,22.0001,21.889,20.7,20.7],[14.64,14.673,14.75,14.76,14.9,14.8216,14.8015]];

    function arrAve(arr) {
        let sum = 0;
        arr.forEach((n) => {
            sum += n;
        });
        return sum / arr.length;
    }

    const leftMaxDiffFractions = [];
    const leftMins = [];
    leftDatasets.forEach((day) => {
        let max = 0;
        let minsFound = 0;
        day.forEach((bar, i) => {
            if (i > 0 && i < day.length - 1) {
                const thisFraction = Math.abs(day[i] / day[i - 1]);
                if (thisFraction > max) {
                    max = thisFraction;
                }
                if (bar === Math.max(day[i - 1], bar, day[i + 1])) {
                    minsFound += 1;
                }
            }
        });
        leftMins.push(minsFound);
        leftMaxDiffFractions.push(max);
    });
    console.log(arrAve(leftMaxDiffFractions), Math.max(...leftMaxDiffFractions), Math.min(...leftMaxDiffFractions));

    const rightMaxDiffFractions = [];
    const rightMins = [];
    rightDatasets.forEach((day) => {
        let max = 0;
        let minsFound = 0;
        day.forEach((bar, i) => {
            if (i > 0 && i < day.length - 1) {
                const thisFraction = Math.abs(day[i] / day[i - 1]);
                if (thisFraction > max) {
                    max = thisFraction;
                }
                if (bar === Math.max(day[i - 1], bar, day[i + 1])) {
                    minsFound += 1;
                }
            }
        });
        rightMins.push(minsFound);
        rightMaxDiffFractions.push(max);
    });
    console.log(arrAve(rightMaxDiffFractions), Math.max(...rightMaxDiffFractions), Math.min(...rightMaxDiffFractions));

    const threshold = 1.04;
    let badsFound = 0;
    let goodsFound = 0;
    rightMaxDiffFractions.forEach((n) => {
        if (n > threshold) {
            goodsFound += 1;
        }
    });
    leftMaxDiffFractions.forEach((n) => {
        if (n > threshold) {
            badsFound += 1;
        }
    });

    console.log("goods found: " + goodsFound);
    console.log("bads found: " + badsFound);

    console.log("*********");
    rightDatasets.push(rightMins);
    leftDatasets.push(leftMins);

    function renderColumn(datasets, containerId, side) {
      const container = document.getElementById(containerId);

      datasets.forEach((data, i) => {
        // Create chart container
        const chartDiv = document.createElement("div");
        chartDiv.className = "chart-container";
        const canvas = document.createElement("canvas");
        chartDiv.appendChild(canvas);
        container.appendChild(chartDiv);

        // Create chart
        new Chart(canvas, {
          type: "line",
          data: {
            labels: data.map((_, idx) => idx + 1),
            datasets: [{
              label: `${side} Dataset ${i + 1}`,
              data: data,
              borderColor: side === "Left" ? "blue" : "green",
              backgroundColor: side === "Left"
                ? "rgba(0, 0, 255, 0.2)"
                : "rgba(0, 128, 0, 0.2)",
              fill: true,
              tension: 0.3
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              x: { title: { display: true, text: "Index" } },
              y: { title: { display: true, text: "Value" } }
            }
          }
        });
      });
    }

    // Render both sides
    renderColumn(leftDatasets, "leftCol", "Left");
    renderColumn(rightDatasets, "rightCol", "Right");
  </script>
</body>
</html>